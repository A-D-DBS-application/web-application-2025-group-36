{% extends "base.html" %}
{% block content %}

<section class="bg-white rounded-2xl shadow-xl border border-gray-200 p-10">
  <div class="flex items-start justify-between flex-wrap gap-4">
    <div>
      <p class="text-sm uppercase tracking-[0.2em] text-gray-500 mb-2">Edit</p>
      <h1 class="text-3xl font-extrabold text-gray-800">Bewerk paper</h1>
      <p class="text-gray-600 max-w-2xl mt-1">Pas titel, abstract, domein of gekoppelde company aan. Alles blijft verbonden in de database.</p>
    </div>
    <a href="{{ url_for('main.paper_detail', paper_id=paper.paper_id) }}" class="text-accent font-semibold hover:underline">Bekijk detail â†’</a>
  </div>

  <form method="post" class="mt-8 grid md:grid-cols-2 gap-8">
    <div class="space-y-6">
      <div>
        <label class="block mb-1 font-semibold">Titel</label>
        <input type="text" name="title" value="{{ paper.title }}" required
               class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent text-black">
      </div>

      <div>
        <label class="block mb-1 font-semibold">Abstract</label>
        <textarea name="abstract" required rows="7"
                  class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent text-black">{{ paper.abstract }}</textarea>
      </div>

      <div>
        <label class="block mb-1 font-semibold">Onderzoeksdomein</label>
        <select name="research_domain" class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent text-black bg-white">
          {% for d in domains %}
            <option value="{{ d }}" {% if paper.research_domain == d %}selected{% endif %}>{{ d }}</option>
          {% endfor %}
          <option value="Other" {% if paper.research_domain not in domains %}selected{% endif %}>Other</option>
        </select>
        <input type="text" name="custom_domain" placeholder="Eigen domein (optioneel)"
               class="w-full mt-2 px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent text-black"
               value="{% if paper.research_domain not in domains %}{{ paper.research_domain }}{% endif %}">
        <p class="text-xs text-gray-500 mt-1">Gebruik dit wanneer je 'Other' selecteert.</p>
      </div>
    </div>

    <div class="space-y-6">
      <div class="bg-gray-50 border border-dashed border-accent/40 rounded-xl p-6">
        <p class="text-sm font-semibold text-gray-700 mb-3">Koppel aan bestaande company</p>
        <select name="company_id" class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent text-black bg-white">
          <option value="">-- Laat huidige koppeling staan of kies nieuw --</option>
          {% for company in companies %}
            <option value="{{ company.company_id }}"
              {% for link in paper.companies %}
                {% if link.company_id == company.company_id %}selected{% endif %}
              {% endfor %}>
              {{ company.name }}
            </option>
          {% endfor %}
        </select>
        <p class="text-xs text-gray-500 mt-2">Als je hier iets kiest, vervangen we de huidige koppeling.</p>
      </div>

      <div class="bg-white border border-gray-200 rounded-xl p-6 shadow-sm">
        <p class="text-sm font-semibold text-gray-700 mb-3">Nieuwe company aanmaken</p>
        <div class="space-y-3">
          <input type="text" name="new_company" placeholder="Bedrijfsnaam" class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent text-black">
          <input type="text" name="new_company_industry" placeholder="Industrie / focus" class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent text-black">
        </div>
        <p class="text-xs text-gray-500 mt-2">We koppelen het paper meteen aan deze nieuwe company.</p>
      </div>

      <button type="submit"
              class="w-full px-6 py-4 bg-accent text-white rounded-xl font-semibold hover:bg-teal-600 transition">
        Opslaan
      </button>
    </div>
  </form>
</section>

{% endblock %}
