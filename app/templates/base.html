<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8">
  <title>{{ title or "REVIEWR" }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap for mobile-friendly layout -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
    crossorigin="anonymous"
  >

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Custom colors -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            accent: "#3bbfb5",
            darkbg: "#ffffff"
          }
        }
      }
    }
  </script>

  <!-- Project styles -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

  <style>
    html, body {
      background-color: #f5f8fc !important;
      color: #222 !important;
      overflow-x: hidden;
      height: 100%;
    }
  </style>

  <!-- Vanta.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r121/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>
</head>

<body class="text-gray-800">

  <!-- NAVBAR -->
  <header class="w-full fixed top-0 z-50 bg-white/90 backdrop-blur border-b border-gray-200">
    <nav class="w-full px-12 py-5 flex items-center justify-between relative">

      <!-- LEFT: LOGO -->
      <a href="{{ url_for('main.index') }}"
         class="text-2xl font-extrabold tracking-wide text-gray-900 hover:text-accent transition">
        REVIEW<span class="text-accent">R</span>
      </a>

      <!-- CENTER NAV LINKS (TRUE CENTERED) -->
      <div class="hidden md:flex absolute left-1/2 -translate-x-1/2 space-x-12 
                  text-gray-700 text-[17px] font-medium items-center">

        <a href="{{ url_for('main.index') }}"
           class="{% if request.endpoint == 'main.index' %}text-accent font-semibold{% else %}hover:text-accent{% endif %} transition">
           Home
        </a>

        <a href="{{ url_for('main.dashboard') }}"
           class="{% if request.endpoint == 'main.dashboard' %}text-accent font-semibold{% else %}hover:text-accent{% endif %} transition">
           Dashboard
        </a>

        <a href="{{ url_for('main.stats') }}"
           class="{% if request.endpoint == 'main.stats' %}text-accent font-semibold{% else %}hover:text-accent{% endif %} transition">
           Stats
        </a>

        <a href="{{ url_for('main.vision') }}"
           class="{% if request.endpoint == 'main.vision' %}text-accent font-semibold{% else %}hover:text-accent{% endif %} transition">
           Vision
        </a>

        <a href="{{ url_for('main.about') }}"
           class="{% if request.endpoint == 'main.about' %}text-accent font-semibold{% else %}hover:text-accent{% endif %} transition">
           About Us
        </a>

      </div>

      <!-- RIGHT: USER BUTTONS -->
      <div class="flex justify-end items-center space-x-4">

        {% if not session.get('user_id') %}

          <a href="{{ url_for('main.register') }}"
             class="border border-accent px-3 py-1.5 rounded-lg text-accent hover:bg-accent hover:text-white transition">
            Create Account
          </a>

          <a href="{{ url_for('main.login') }}"
             class="px-3 py-1.5 bg-accent text-white rounded-lg font-semibold hover:bg-teal-600 transition">
            Login
          </a>

        {% else %}

          <!-- PROFILE DROPDOWN -->
          <div class="relative" x-data="{ open: false }">

            <button @click="open = !open"
                    class="flex items-center space-x-2 px-4 py-2 bg-accent text-white rounded-lg font-semibold hover:bg-teal-600 transition">
              <span>{{ session.get('user_name') }}</span>
              <span class="text-sm opacity-90">({{ session.get('user_role') }})</span>
            </button>

            <div x-show="open"
                 @click.outside="open = false"
                 class="absolute right-0 mt-3 w-52 bg-white border border-gray-200 rounded-lg shadow-lg py-2 z-50">

              <!-- VIEW PROFILE -->
              <a href="{{ url_for('main.profile') }}"
                 class="block px-4 py-2 text-gray-700 hover:bg-teal-50 hover:text-accent transition">
                 View Profile
              </a>

              {% if session.get('user_role') in ["System/Admin", "Founder"] %}
                <a href="{{ url_for('main.add_company') }}"
                   class="block px-4 py-2 text-gray-700 hover:bg-teal-50 hover:text-accent transition">
                  Add Company
                </a>
              {% endif %}

              <a href="{{ url_for('main.change_role') }}"
                 class="block px-4 py-2 text-gray-700 hover:bg-teal-50 hover:text-accent transition">
                 Change Role
              </a>

              <a href="{{ url_for('main.logout') }}"
                 class="block px-4 py-2 text-gray-700 hover:bg-red-50 hover:text-red-600 transition">
                 Log Out
              </a>

            </div>
          </div>

          <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

        {% endif %}

      </div>
    </nav>
  </header>

  <!-- Vanta Background -->
  <div id="vanta-bg" class="absolute top-0 left-0 w-full h-full -z-10 opacity-20"></div>

  <script>
    VANTA.NET({
      el: "#vanta-bg",
      color: 0x3bbfb5,
      backgroundColor: 0xf5f8fc,
      points: 8.00,
      maxDistance: 18.00,
      spacing: 20.00
    })
  </script>

  <!-- Bootstrap bundle (JS + Popper) -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"
  ></script>

  <!-- FLASH MESSAGES -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="pt-28 px-8 max-w-4xl mx-auto space-y-2">
        {% for category, message in messages %}
          <div class="px-4 py-3 rounded-xl text-sm border
                      {% if category == 'error' %}
                        bg-red-50 text-red-700 border-red-200
                      {% elif category == 'success' %}
                        bg-emerald-50 text-emerald-700 border-emerald-200
                      {% else %}
                        bg-gray-50 text-gray-700 border-gray-200
                      {% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <!-- PAGE CONTENT -->
  <main class="pt-40 pb-20 px-8 max-w-6xl mx-auto">
    {% block content %}{% endblock %}
  </main>

</body>
</html>
